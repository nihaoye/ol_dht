<!DOCTYPE html>
<html>
<head>
	<title>Geolocation</title>
	<meta name="viewport" id="viewport" content="width=device-width, initial-scale=1">
	<meta name="format-detection" content="telephone=no">
	<meta name="format-detection" content="telephone=no"/>
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
	<link rel="stylesheet" href="https://openlayers.org/en/v4.6.5/css/ol.css" type="text/css">
	<link rel="stylesheet" href="css/css.css?v=11" type="text/css">
	<script src="https://openlayers.org/en/v4.6.5/build/ol.js"></script>
	<!--	<script src="http://res.wx.qq.com/open/js/jweixin-1.1.0.js"></script>-->
	<script src="js/fed-transform.js"></script>
	<script src="js/mydis.js?v=1asfdasdfasdf2"></script>
</head>
<body>
<div id="map" class="map"></div>
<div id="mouse-position" style="top:10px;left:10px;position:absolute;font-size:30px;"></div>
<span id="myposition"></span>
<script>
	var extent=[113.970207061,113.98584012,22.763953671,22.772405516];
	var sourceProj='EPSG:4326';
	var targetProj="EPSG:4326";
	var view = new ol.View({
		enableRotation:false,
		projection: targetProj,
		center:fc.proj.transform([113.9672493,22.60450238],sourceProj,targetProj),
		zoom: 18,
		minZoom:15
		/*	extent:extent,*/
		/*	rotation:-1.5707963*/
	});
	var image=new ol.source.ImageStatic({
	 url: 'images/dt5.jpg',
	 projection: 'EPSG:4326',
	 imageExtent: extent
	 });

	 var layer=new ol.layer.Image({
	 opacity:0.9,
	 source:image
	 });
	var map = new ol.Map({
		loadTilesWhileAnimating:true,
		controls: ol.control.defaults({
			attributionOptions: {
				collapsible: false
			}
		}),
		layers: [
			new ol.layer.Tile({
				title: "天地图路网",
				source: new ol.source.XYZ({
					url: "http://t4.tianditu.com/DataServer?T=vec_w&x={x}&y={y}&l={z}"
				})
			}),
			new ol.layer.Tile({
				title: "天地图文字标注",
				source: new ol.source.XYZ({
					url: 'http://t3.tianditu.com/DataServer?T=cva_w&x={x}&y={y}&l={z}'
				})
			}),
			layer
		],
		target: 'map',
		view: view
	});
	var mydis=new Mydis({id:'mydis',map:map});
	var isFirst=true;
	var info=document.getElementById('mouse-position');
	mydis.events.changePosition=function(p){
		if(isFirst){
			map.getView().setCenter(p);
			isFirst=false;
		}
		var hp=ol.proj.transform(p,targetProj,'EPSG:4326');
		//info.innerHTML=hp[0].toFixed(6)+","+hp[1].toFixed(6);

	};
	window.onload=function(){
		document.getElementById('myposition').onclick=function(e){
			map.getView().animate({
				center: mydis.position,
				duration: 1000
			});
		}
	};
</script>
</body>
</html>
